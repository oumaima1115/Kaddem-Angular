<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">

<!--begin::Post-->
<!--post d-flex flex-column-fluid-->
<div  class=" postPos " id="kt_post" id="main-post" >
  <div class="container blog-page=" style="width:93rem;position:absolute;margin-left: 18%;height:auto">
    <div class="row">
        <div class="col-lg-12">
            <div class="main-box clearfix">
                <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
                <div class="container">
                <div class="row">
                    <div class="col-lg-12">
                        <div class="main-box clearfix">
                            <div class="table-responsive">
                
                <ng-template #noIssue>
                    <img src="../../../../../assets/NoIssues.png" style="margin-left: 26%;"/>
                    <h5 style="margin-left:35%">No issues were found matching your search</h5>
                    <span style="margin-left:42%">
                        Be the first to 
                        <a class="table-link secondary" style="color:#0052CC"
                            (click)="onOpenModal(null, 'add')">
                                create an issue
                        </a>
                    </span>
                </ng-template>
                <div class="table-responsive" *ngIf="tache.length != 0;else noIssue">
                    <div class="btn-toolbar justify-content-between" role="toolbar" aria-label="Toolbar with button groups">
                        <div class="btn-group" role="group" aria-label="First group">

                            <div class="input-group">
                                <div class="form-outline">
                                <input [(ngModel)]="searchText" placeholder="Search issues" autocomplete="on" name="search"
                                type="search" id="form1" class="form-control" style="width: 255px;height: 41px;"/>
                                </div>
                            </div>
                            <button type="button" class="btn btn-secondary" 
                                style="font-family: sans-serif;font-weight: bold;color:#F4F5F7;background-color:#253858;font-family: sans-serif;margin-left: 8px;border-radius: 5px;" 
                                (click)="onOpenModal(null, 'removeAll')">
                                Remove All
                            </button>
                            <div>
                                <a class="nav-link" href="http://example.com" id="dropdown01" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    <button type="button" class="btn btn-secondary dropdown-toggle" 
                                        style="background-color: #F5F6F8;color:#42526E; font-family: sans-serif;font-weight: bold;margin-left: 8px;">
                                            Export Issue
                                    </button> 
                                </a>
                                <div class="dropdown-menu" aria-labelledby="dropdown01">
                                    <a class="dropdown-item" href="#">Print details</a>
                                    <a class="dropdown-item" href="#"></a>
                                    <a class="dropdown-item" href="#">Export XML</a>
                                    <a class="dropdown-item" href="#">Export RSS</a>
                                    <a class="dropdown-item" href="#">Export RSS (with comments)</a>
                                    <a class="dropdown-item" href="#">Export Word</a>
                                    <a class="dropdown-item" href="#">Export HTML report (all fields)</a>
                                    <a class="dropdown-item" href="#">Export Excel CSV (all fields)</a>
                                </div>    
                            </div>
                            <div>
                            <a class="nav-link" href="http://example.com" id="dropdown01" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                <button type="button" class="btn btn-secondary dropdown-toggle" 
                                    style="background-color: #F5F6F8;color:#42526E; font-family: sans-serif;font-weight: bold;margin-left: 8px;">
                                        Status
                                </button> 
                            </a>
                            <div class="dropdown-menu" aria-labelledby="dropdown01">
                                <a class="dropdown-item" href="#"><img src=""/> TODO</a>
                                <a class="dropdown-item" href="#">INPROGRESS</a>
                                <a class="dropdown-item" href="#">CODEREVIEW</a>
                                <a class="dropdown-item" href="#">DONE</a>
                            </div>
                        </div>
                        </div>
                        <div class="input-group">
                          <div class="input-group-prepend">
                            <a class="table-link secondary">
                                <button type="button" class="btn btn-primary" 
                                    style="background-color: #0052CC; font-family: sans-serif;font-weight: bold;" 
                                    (click)="onOpenModal(null, 'add')">
                                    Create
                                </button> 
                            </a>
                          </div>
                        </div>
                    </div><br>
                    <table class="table user-list"  id="projects">
                        <thead>
                            <tr>
                                <th><span>Type</span></th>
                                <th><span>Key</span></th>
                                <th class="text-center"><span>Summary</span></th>
                                <th><span>Status</span></th>
                                <th><span>Resolution</span></th>
                                <th><span>Created</span></th>
                                <th><span>Updated</span></th>
                                <th>&nbsp;</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let tache of tache | filter: searchText | paginate:{itemsPerPage: tableSize,
                                        currentPage: page,
                                        totalItems:count};let i = index" >
                                <td>
                                    <img *ngIf="tache.type == 'BUG'" src="../../../../../assets/BUG.png" alt="" width="20px"height="20px">
                                    <img *ngIf="tache.type == 'EPIC'" src="../../../../../assets/EPIC.png" alt="" width="20px"height="20px">
                                    <img *ngIf="tache.type == 'STORY'" src="../../../../../assets/STORY.png" alt="" width="20px"height="20px">
                                    <img *ngIf="tache.type == 'TASK'" src="../../../../../assets/TASK.png" alt="" width="20px"height="20px">
                                </td>
                                <td>
                                    <span class="user-subhead">{{tache.nomTache}}</span>
                                </td>
                                <td>
                                    <span class="user-subhead">{{tache.descriptionTache}}</span>
                                </td>
                                <td>
                                    <span class="user-subhead">{{tache.etat}}</span>
                                </td>
                                <td>
                                    <span class="user-subhead">{{tache.etat}}</span>
                                </td>
                                <td>
                                    {{tache.created}}
                                </td>
                                <td>
                                    {{tache.updated}}
                                </td>
                                <td >
                                    <a class="nav-link " href="http://example.com" id="dropdown01" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                        <span class="bi bi-three-dots"></span>
                                    </a>
                                    <div class="dropdown-menu" aria-labelledby="dropdown01">
                                        <a class="dropdown-item" >To Active Sprint</a>
                                        <a class="dropdown-item" (click)="onOpenModal(tache, 'edit')">Edit</a>
                                        <a class="dropdown-item" (click)="onOpenModal(tache, 'delete')">Delete Issue</a>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>

                    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
                    <pagination-controls  
                         previousLabel="Prev"
                         nextLabel="Next"
                         (pageChange)="onTableDataChange($event)">
                    </pagination-controls>
                </div>
            </div>
        </div>
    </div>
  </div>
  <!--end::Container-->
</div>
<!--end::Post-->	

                <!-- Add Issue Modal -->
                <div class="modal fade" id="addTacheModal" tabindex="-1" role="dialog" aria-labelledby="addEmployeeModalLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="addEmployeeModalLabel">Create issue</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            </button>
                        </div>
                        <div class="modal-body">
                            <form #addForm="ngForm" (ngSubmit)="onAddIssue(addForm)">
                                <div class="form-group">
                                    <label for="key"><span style="color:#6B778C;font-family: Arial, Helvetica, sans-serif;">Key</span><span style="color:#DE350B">*</span></label>
                                    <input type="text" minlength="2" pattern="[a-zA-Z0-9 ]*" ngModel name="key" #key="ngModel" 
                                         [class]="addForm.valid?'form-control is-valid':'form-control'" id="key"  required>
                                    <div class="alert alert-danger" *ngIf="key.invalid && key.touched">Key is required</div>
                                    <div class="alert alert-danger" *ngIf="key.errors?.['minlength'] && !key.untouched">Min length is two</div>
                                    <div class="alert alert-danger" *ngIf="key.errors?.['pattern'] && !key.untouched">key should be contains letters</div> 
                                </div>
                                <div class="form-group">
                                    <label for="summary"><span style="color:#6B778C">Summary</span><span style="color:#DE350B">*</span></label>
                                    <input type="text" minlength="3" ngModel name="summary" #summary="ngModel" 
                                        [class]="addForm.valid?'form-control is-valid':'form-control'"  id="summary"  required>
                                    <div class="alert alert-danger" *ngIf="summary.invalid && summary.touched">Summary is required</div>
                                    <div class="alert alert-danger" *ngIf="summary.errors?.['minlength'] && !summary.untouched">Min length is three</div>
                                </div>
                                <div class="form-group">
                                    <label for="status"><span style="color:#6B778C">Status</span><span style="color:#DE350B">*</span></label><br>
                                    <select 
                                        [class]="addForm.valid?'form-control is-valid':'form-control'" 
                                        required ngModel name="status" #status="ngModel">  
                                            <option class="dropdown-item" value="TODO">TODO</option> 
                                            <option class="dropdown-item" value="INPROGRESS">INPROGRESS</option>
                                            <option class="dropdown-item" value="CODEREVIEW">CODEREVIEW</option>
                                            <option class="dropdown-item" value="DONE">DONE</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="typeTache"><span style="color:#6B778C">Issue type</span><span style="color:#DE350B">*</span></label>
                                    <select
                                        [class]="addForm.valid?'form-control is-valid':'form-control'" 
                                        required ngModel name="typeTache" #typeTache="ngModel">  
                                            <option class="dropdown-item" value="STORY"> STORY</option> 
                                            <option class="dropdown-item" value="TASK">TASK</option>
                                            <option class="dropdown-item" value="BUG">BUG</option>
                                            <option class="dropdown-item" value="EPIC">EPIC</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="createdDate"><span style="color:#6B778C">Created Date</span></label>
                                    <input type="Date" ngModel name="createdDate" #createdDate="ngModel"  [class]="addForm.valid?'form-control is-valid':'form-control'"  id="createdDate">
                                </div>
                                <div class="form-group">
                                    <label for="updatedDate"><span style="color:#6B778C">Updated Date</span></label>
                                    <input type="Date" ngModel name="updatedDate" #updatedDate="ngModel" [class]="addForm.valid?'form-control is-valid':'form-control'"  id="updatedDate">
                                </div>
                                <div class="modal-footer">
                                    <button type="button" id="add-tache-form" 
                                        class="btn btn-outline-secondary" data-dismiss="modal" >
                                        Cancel
                                    </button>
                                    <button [disabled]="addForm.invalid" type="submit" 
                                        class="btn btn-primary" 
                                        style="background-color: #0052CC;">
                                        Create
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                    </div>
                </div>

                <!-- Edit Modal -->
                <div class="modal fade" id="editTacheModal" tabindex="-1" role="dialog" aria-labelledby="employeeEditModalLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="updateEmployeeModalLabel">Update {{editTache?.nomTache}}</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            </button>
                        </div>
                        <div class="modal-body">
                            <form #editForm="ngForm">
                                <div class="form-group">
                                    <label for="key"><span style="color:#6B778C;font-family: Arial, Helvetica, sans-serif;">Key</span><span style="color:#DE350B">*</span></label>
                                    <input required type="text" minlength="2" pattern="[a-zA-Z0-9 ]*"  name="key" ngModel="{{editTache?.nomTache}}"  #key="ngModel"  [class]="editForm.valid?'form-control is-valid':'form-control'"  id="key" >
                                    <div class="alert alert-danger" *ngIf="key.invalid && key.touched">Key is required</div>
                                    <div class="alert alert-danger" *ngIf="key.errors?.['minlength'] && !key.untouched">Min length is two</div>
                                    <div class="alert alert-danger" *ngIf="key.errors?.['pattern'] && !key.untouched">key should be contains letters</div> 
                                </div>
                                <input type="hidden" name="idTache" ngModel="{{editTache?.idTache}}"  #idTache="ngModel" class="form-control" id="idTache" >
                                <div class="form-group">
                                <label for="summary">Summary </label>
                                <input type="text" required name="summary" ngModel="{{editTache?.descriptionTache}}"  #summary="ngModel"  [class]="editForm.valid?'form-control is-valid':'form-control'"  id="summary" >
                                </div>
                                <div class="form-group">
                                    <label for="status"><span style="color:#6B778C">Status</span><span style="color:#DE350B">*</span></label><br>
                                    <select 
                                        [class]="editForm.valid?'form-control is-valid':'form-control'" 
                                        required ngModel="{{editTache?.etat}}" name="status" #status="ngModel" id="status">  
                                            <option class="dropdown-item" value="TODO">TODO</option> 
                                            <option class="dropdown-item" value="INPROGRESS">INPROGRESS</option>
                                            <option class="dropdown-item" value="CODEREVIEW">CODEREVIEW</option>
                                            <option class="dropdown-item" value="DONE">DONE</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="typeTache"><span style="color:#6B778C">Issue type</span><span style="color:#DE350B">*</span></label>
                                    <select
                                        [class]="editForm.valid?'form-control is-valid':'form-control'" 
                                        required ngModel="{{editTache?.type}}" name="typeTache" #typeTache="ngModel">  
                                            <option class="dropdown-item" value="STORY">STORY</option> 
                                            <option class="dropdown-item" value="TASK">TASK</option>
                                            <option class="dropdown-item" value="BUG">BUG</option>
                                            <option class="dropdown-item" value="EPIC">EPIC</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="createdDate"><span style="color:#6B778C">Created Date</span></label>
                                    <input type="Date" ngModel="{{editTache?.created}}" name="createdDate" #createdDate="ngModel"  [class]="editForm.valid?'form-control is-valid':'form-control'"  id="createdDate">
                                </div>
                                <div class="form-group">
                                    <label for="updatedDate"><span style="color:#6B778C">Updated Date</span></label>
                                    <input type="Date" ngModel="{{editTache?.updated}}" name="updatedDate" #updatedDate="ngModel" [class]="editForm.valid?'form-control is-valid':'form-control'"  id="updatedDate">
                                </div>
                                
                                <div class="modal-footer">
                                <button type="button" id="" data-dismiss="modal" class="btn btn-secondary">Cancel</button>
                                <button (click)="onUpdateTache(editForm)" data-dismiss="modal"
                                    [disabled]="editForm.invalid" type="submit" 
                                    class="btn btn-primary" 
                                    style="background-color: #0052CC;">
                                        Save changes</button>
                                </div>
                            </form>
                        </div>
                    </div>
                    </div>
                </div>
                <!--End Edit Modal-->

                
                <!-- Delete Modal -->
                <div class="modal fade" id="deleteTacheModal" tabindex="-1" role="dialog" aria-labelledby="deleteModelLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="deleteModelLabel">Delete {{deleteTache?.nomTache}}?</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            </button>
                        </div>
                        <div class="modal-body">
                            <h6 style="font-family: sans-serif;font-weight: bold;">You're about to permanently delete this issue and all of its data.</h6>
                            <h6>If you're not sure, you can resolve or close this issue instead.</h6>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Cancel</button>
                                <button (click)="onRemoveTache(deleteTache?.idTache)" style="background-color: #DE350B;font-family: sans-serif;font-weight: bold;" 
                                class="btn btn-danger" data-dismiss="modal">
                                    Delete
                            </button>
                            </div>
                        </div>
                    </div>
                    </div>
                </div>
                
                <!--End Delete Model-->

                   <!-- All Delete Modal -->
                   <div class="modal fade" id="deleteAllTacheModal" tabindex="-1" role="dialog" aria-labelledby="deleteAllModelLabel" aria-hidden="true">
                    <div class="modal-dialog" role="document">
                    <div class="modal-content">
                        <div class="modal-header">
                            <h5 class="modal-title" id="deleteAllModelLabel">Delete All Issues</h5>
                            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                            </button>
                        </div>
                        <div class="modal-body">
                            <h6 style="font-family: sans-serif;font-weight: bold;">You're about to permanently delete this issue and all of its data.</h6>
                            <h6>If you're not sure, you can resolve or close this issue instead.</h6>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-outline-secondary" data-dismiss="modal">Cancel</button>
                                <button (click)="removeAllTache()" style="background-color: #DE350B;font-family: sans-serif;font-weight: bold;" 
                                class="btn btn-danger" data-dismiss="modal">
                                    Delete
                            </button>
                            </div>
                        </div>
                    </div>
                    </div>
                </div>
                
                <!--End All Delete Model-->